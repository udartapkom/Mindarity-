# Требования к инфраструктуре для проекта "Mindarity"

## Серверные требования

### VDS/Сервер
- **Минимальные требования:**
  - RAM: 4GB
  - CPU: 2 ядра
  - SSD: 50GB
  - ОС: Ubuntu 20.04+ или CentOS 8+

- **Рекомендуемые требования:**
  - RAM: 8GB
  - CPU: 4 ядра
  - SSD: 100GB
  - ОС: Ubuntu 22.04 LTS

### Доменное имя
- Доменное имя для настройки HTTPS
- Желательно с поддержкой wildcard сертификатов
- DNS записи для основного домена и поддоменов

## Необходимые сервисы

### База данных
- **PostgreSQL 14+**
  - Порт: 5432
  - Минимум 10GB места для БД
  - Настройка резервного копирования

### Кэширование и сессии
- **Redis 6+**
  - Порт: 6379
  - Минимум 2GB RAM для Redis
  - Настройка персистентности

### Поисковый движок
- **Elasticsearch 8+**
  - Порт: 9200
  - Минимум 4GB RAM для Elasticsearch
  - Настройка кластера (минимум 1 узел)

### Объектовое хранилище
- **MinIO**
  - Порт: 9000 (API), 9001 (Console)
  - Минимум 50GB места для файлов
  - Настройка S3-совместимого API

### Аутентификация
- **Keycloak 22+**
  - Порт: 8080
  - Минимум 2GB RAM для Keycloak
  - Настройка OAuth2/OIDC

### CI/CD
- **Jenkins**
  - Порт: 8080
  - Минимум 2GB RAM для Jenkins
  - Настройка pipeline'ов

### Мониторинг
- **Prometheus**
  - Порт: 9090
  - Сбор метрик с всех сервисов

- **Grafana**
  - Порт: 3000
  - Дашборды для мониторинга
  - Интеграция с Prometheus

### Веб-сервер
- **Nginx**
  - Порт: 80, 443
  - Reverse proxy для всех сервисов
  - SSL/TLS сертификаты

## Сетевые требования

### Порты
- 22 (SSH)
- 80 (HTTP)
- 443 (HTTPS)
- 3000 (Grafana)
- 8080 (Jenkins/Keycloak)
- 9000 (MinIO API)
- 9001 (MinIO Console)
- 9090 (Prometheus)
- 9200 (Elasticsearch)
- 5432 (PostgreSQL)
- 6379 (Redis)

### SSL сертификаты
- Let's Encrypt (бесплатный) или платный сертификат
- Wildcard сертификат для поддоменов
- Автоматическое обновление

## Docker окружение

### Docker Compose
- Все сервисы должны быть контейнеризированы
- Отдельные сети для разных групп сервисов
- Volume'ы для персистентных данных

### Контейнеры
- mindarity-backend
- mindarity-frontend
- postgres
- redis
- elasticsearch
- minio
- keycloak
- jenkins
- prometheus
- grafana
- nginx

## Резервное копирование

### Автоматические бэкапы
- PostgreSQL: ежедневно
- MinIO: еженедельно
- Конфигурационные файлы: ежедневно
- Логи: еженедельно

### Хранение бэкапов
- Минимум 30 дней хранения
- Отдельное хранилище для бэкапов
- Тестирование восстановления

## Мониторинг и алерты

### Метрики
- CPU, RAM, Disk usage
- Network traffic
- Application metrics
- Database performance
- Response times

### Алерты
- Загрузка ресурсов > 85%
- Недоступность сервисов
- Ошибки в логах
- Проблемы с БД
- Проблемы с дисковым пространством

## Безопасность

### Файрвол
- UFW или iptables
- Ограничение доступа по IP
- Закрытие неиспользуемых портов

### Обновления
- Регулярные обновления ОС
- Обновления Docker образов
- Обновления зависимостей

### Логирование
- Централизованное логирование
- Ротация логов
- Мониторинг подозрительной активности

## Масштабирование

### Горизонтальное масштабирование
- Load balancer для backend
- Кластер Elasticsearch
- Репликация PostgreSQL
- Redis Cluster

### Вертикальное масштабирование
- Возможность увеличения ресурсов VDS
- Мониторинг производительности
- Планирование апгрейдов

## Стоимость оценки

### Минимальная конфигурация
- VDS 4GB RAM, 2 CPU, 50GB SSD: ~$20-30/месяц
- Доменное имя: ~$10-15/год
- SSL сертификат: бесплатно (Let's Encrypt)

### Рекомендуемая конфигурация
- VDS 8GB RAM, 4 CPU, 100GB SSD: ~$40-60/месяц
- Доменное имя: ~$10-15/год
- SSL сертификат: бесплатно (Let's Encrypt)